{"ast":null,"code":"/*\n * Copyright 2013-2016 the original author or authors\n * @license MIT, see LICENSE.txt for details\n *\n * @author Scott Andrews\n */\n'use strict';\n\nvar pathPrefix, template, find, lazyPromise, responsePromise;\npathPrefix = require('../../../interceptor/pathPrefix');\ntemplate = require('../../../interceptor/template');\nfind = require('../../../util/find');\nlazyPromise = require('../../../util/lazyPromise');\nresponsePromise = require('../../../util/responsePromise');\n\nfunction defineProperty(obj, name, value) {\n  Object.defineProperty(obj, name, {\n    value: value,\n    configurable: true,\n    enumerable: false,\n    writeable: true\n  });\n}\n/**\n * Hypertext Application Language serializer\n *\n * Implemented to https://tools.ietf.org/html/draft-kelly-json-hal-06\n *\n * As the spec is still a draft, this implementation will be updated as the\n * spec evolves\n *\n * Objects are read as HAL indexing links and embedded objects on to the\n * resource. Objects are written as plain JSON.\n *\n * Embedded relationships are indexed onto the resource by the relationship\n * as a promise for the related resource.\n *\n * Links are indexed onto the resource as a lazy promise that will GET the\n * resource when a handler is first registered on the promise.\n *\n * A `requestFor` method is added to the entity to make a request for the\n * relationship.\n *\n * A `clientFor` method is added to the entity to get a full Client for a\n * relationship.\n *\n * The `_links` and `_embedded` properties on the resource are made\n * non-enumerable.\n */\n\n\nmodule.exports = {\n  read: function read(str, opts) {\n    var client, console;\n    opts = opts || {};\n    client = opts.client;\n    console = opts.console || console;\n\n    function deprecationWarning(relationship, deprecation) {\n      if (deprecation && console && console.warn || console.log) {\n        (console.warn || console.log).call(console, 'Relationship \\'' + relationship + '\\' is deprecated, see ' + deprecation);\n      }\n    }\n\n    return opts.registry.lookup(opts.mime.suffix).then(function (converter) {\n      return converter.read(str, opts);\n    }).then(function (root) {\n      find.findProperties(root, '_embedded', function (embedded, resource, name) {\n        Object.keys(embedded).forEach(function (relationship) {\n          if (relationship in resource) {\n            return;\n          }\n\n          var related = responsePromise({\n            entity: embedded[relationship]\n          });\n          defineProperty(resource, relationship, related);\n        });\n        defineProperty(resource, name, embedded);\n      });\n      find.findProperties(root, '_links', function (links, resource, name) {\n        Object.keys(links).forEach(function (relationship) {\n          var link = links[relationship];\n\n          if (relationship in resource) {\n            return;\n          }\n\n          defineProperty(resource, relationship, responsePromise.make(lazyPromise(function () {\n            if (link.deprecation) {\n              deprecationWarning(relationship, link.deprecation);\n            }\n\n            if (link.templated === true) {\n              return template(client)({\n                path: link.href\n              });\n            }\n\n            return client({\n              path: link.href\n            });\n          })));\n        });\n        defineProperty(resource, name, links);\n        defineProperty(resource, 'clientFor', function (relationship, clientOverride) {\n          var link = links[relationship];\n\n          if (!link) {\n            throw new Error('Unknown relationship: ' + relationship);\n          }\n\n          if (link.deprecation) {\n            deprecationWarning(relationship, link.deprecation);\n          }\n\n          if (link.templated === true) {\n            return template(clientOverride || client, {\n              template: link.href\n            });\n          }\n\n          return pathPrefix(clientOverride || client, {\n            prefix: link.href\n          });\n        });\n        defineProperty(resource, 'requestFor', function (relationship, request, clientOverride) {\n          var client = this.clientFor(relationship, clientOverride);\n          return client(request);\n        });\n      });\n      return root;\n    });\n  },\n  write: function write(obj, opts) {\n    return opts.registry.lookup(opts.mime.suffix).then(function (converter) {\n      return converter.write(obj, opts);\n    });\n  }\n};","map":{"version":3,"names":["pathPrefix","template","find","lazyPromise","responsePromise","require","defineProperty","obj","name","value","Object","configurable","enumerable","writeable","module","exports","read","str","opts","client","console","deprecationWarning","relationship","deprecation","warn","log","call","registry","lookup","mime","suffix","then","converter","root","findProperties","embedded","resource","keys","forEach","related","entity","links","link","make","templated","path","href","clientOverride","Error","prefix","request","clientFor","write"],"sources":["D:/Chronicle/chronicle-ttm/src/main/frontend/node_modules/rest/mime/type/application/hal.js"],"sourcesContent":["/*\n * Copyright 2013-2016 the original author or authors\n * @license MIT, see LICENSE.txt for details\n *\n * @author Scott Andrews\n */\n\n'use strict';\n\nvar pathPrefix, template, find, lazyPromise, responsePromise;\n\npathPrefix = require('../../../interceptor/pathPrefix');\ntemplate = require('../../../interceptor/template');\nfind = require('../../../util/find');\nlazyPromise = require('../../../util/lazyPromise');\nresponsePromise = require('../../../util/responsePromise');\n\nfunction defineProperty(obj, name, value) {\n\tObject.defineProperty(obj, name, {\n\t\tvalue: value,\n\t\tconfigurable: true,\n\t\tenumerable: false,\n\t\twriteable: true\n\t});\n}\n\n/**\n * Hypertext Application Language serializer\n *\n * Implemented to https://tools.ietf.org/html/draft-kelly-json-hal-06\n *\n * As the spec is still a draft, this implementation will be updated as the\n * spec evolves\n *\n * Objects are read as HAL indexing links and embedded objects on to the\n * resource. Objects are written as plain JSON.\n *\n * Embedded relationships are indexed onto the resource by the relationship\n * as a promise for the related resource.\n *\n * Links are indexed onto the resource as a lazy promise that will GET the\n * resource when a handler is first registered on the promise.\n *\n * A `requestFor` method is added to the entity to make a request for the\n * relationship.\n *\n * A `clientFor` method is added to the entity to get a full Client for a\n * relationship.\n *\n * The `_links` and `_embedded` properties on the resource are made\n * non-enumerable.\n */\nmodule.exports = {\n\n\tread: function (str, opts) {\n\t\tvar client, console;\n\n\t\topts = opts || {};\n\t\tclient = opts.client;\n\t\tconsole = opts.console || console;\n\n\t\tfunction deprecationWarning(relationship, deprecation) {\n\t\t\tif (deprecation && console && console.warn || console.log) {\n\t\t\t\t(console.warn || console.log).call(console, 'Relationship \\'' + relationship + '\\' is deprecated, see ' + deprecation);\n\t\t\t}\n\t\t}\n\n\t\treturn opts.registry.lookup(opts.mime.suffix).then(function (converter) {\n\t\t\treturn converter.read(str, opts);\n\t\t}).then(function (root) {\n\t\t\tfind.findProperties(root, '_embedded', function (embedded, resource, name) {\n\t\t\t\tObject.keys(embedded).forEach(function (relationship) {\n\t\t\t\t\tif (relationship in resource) { return; }\n\t\t\t\t\tvar related = responsePromise({\n\t\t\t\t\t\tentity: embedded[relationship]\n\t\t\t\t\t});\n\t\t\t\t\tdefineProperty(resource, relationship, related);\n\t\t\t\t});\n\t\t\t\tdefineProperty(resource, name, embedded);\n\t\t\t});\n\t\t\tfind.findProperties(root, '_links', function (links, resource, name) {\n\t\t\t\tObject.keys(links).forEach(function (relationship) {\n\t\t\t\t\tvar link = links[relationship];\n\t\t\t\t\tif (relationship in resource) { return; }\n\t\t\t\t\tdefineProperty(resource, relationship, responsePromise.make(lazyPromise(function () {\n\t\t\t\t\t\tif (link.deprecation) { deprecationWarning(relationship, link.deprecation); }\n\t\t\t\t\t\tif (link.templated === true) {\n\t\t\t\t\t\t\treturn template(client)({ path: link.href });\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn client({ path: link.href });\n\t\t\t\t\t})));\n\t\t\t\t});\n\t\t\t\tdefineProperty(resource, name, links);\n\t\t\t\tdefineProperty(resource, 'clientFor', function (relationship, clientOverride) {\n\t\t\t\t\tvar link = links[relationship];\n\t\t\t\t\tif (!link) {\n\t\t\t\t\t\tthrow new Error('Unknown relationship: ' + relationship);\n\t\t\t\t\t}\n\t\t\t\t\tif (link.deprecation) { deprecationWarning(relationship, link.deprecation); }\n\t\t\t\t\tif (link.templated === true) {\n\t\t\t\t\t\treturn template(\n\t\t\t\t\t\t\tclientOverride || client,\n\t\t\t\t\t\t\t{ template: link.href }\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn pathPrefix(\n\t\t\t\t\t\tclientOverride || client,\n\t\t\t\t\t\t{ prefix: link.href }\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t\tdefineProperty(resource, 'requestFor', function (relationship, request, clientOverride) {\n\t\t\t\t\tvar client = this.clientFor(relationship, clientOverride);\n\t\t\t\t\treturn client(request);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn root;\n\t\t});\n\n\t},\n\n\twrite: function (obj, opts) {\n\t\treturn opts.registry.lookup(opts.mime.suffix).then(function (converter) {\n\t\t\treturn converter.write(obj, opts);\n\t\t});\n\t}\n\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}