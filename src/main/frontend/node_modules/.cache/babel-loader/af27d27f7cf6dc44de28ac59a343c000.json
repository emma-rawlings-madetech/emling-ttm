{"ast":null,"code":"/*\n * Copyright 2012-2016 the original author or authors\n * @license MIT, see LICENSE.txt for details\n *\n * @author Scott Andrews\n */\n'use strict';\n\nvar normalizeHeaderName, responsePromise, client, headerSplitRE;\nnormalizeHeaderName = require('../util/normalizeHeaderName');\nresponsePromise = require('../util/responsePromise');\nclient = require('../client'); // according to the spec, the line break is '\\r\\n', but doesn't hold true in practice\n\nheaderSplitRE = /[\\r|\\n]+/;\n\nfunction parseHeaders(raw) {\n  // Note: Set-Cookie will be removed by the browser\n  var headers = {};\n\n  if (!raw) {\n    return headers;\n  }\n\n  raw.trim().split(headerSplitRE).forEach(function (header) {\n    var boundary, name, value;\n    boundary = header.indexOf(':');\n    name = normalizeHeaderName(header.substring(0, boundary).trim());\n    value = header.substring(boundary + 1).trim();\n\n    if (headers[name]) {\n      if (Array.isArray(headers[name])) {\n        // add to an existing array\n        headers[name].push(value);\n      } else {\n        // convert single value to array\n        headers[name] = [headers[name], value];\n      }\n    } else {\n      // new, single value\n      headers[name] = value;\n    }\n  });\n  return headers;\n}\n\nfunction safeMixin(target, source) {\n  Object.keys(source || {}).forEach(function (prop) {\n    // make sure the property already exists as\n    // IE 6 will blow up if we add a new prop\n    if (source.hasOwnProperty(prop) && prop in target) {\n      try {\n        target[prop] = source[prop];\n      } catch (e) {// ignore, expected for some properties at some points in the request lifecycle\n      }\n    }\n  });\n  return target;\n}\n\nmodule.exports = client(function xhr(request) {\n  return responsePromise.promise(function (resolve, reject) {\n    /*jshint maxcomplexity:20 */\n    var client, method, url, headers, entity, headerName, response, XHR;\n    request = typeof request === 'string' ? {\n      path: request\n    } : request || {};\n    response = {\n      request: request\n    };\n\n    if (request.canceled) {\n      response.error = 'precanceled';\n      reject(response);\n      return;\n    }\n\n    XHR = request.engine || XMLHttpRequest;\n\n    if (!XHR) {\n      reject({\n        request: request,\n        error: 'xhr-not-available'\n      });\n      return;\n    }\n\n    entity = request.entity;\n    request.method = request.method || (entity ? 'POST' : 'GET');\n    method = request.method;\n    url = response.url = request.path || '';\n\n    try {\n      client = response.raw = new XHR(); // mixin extra request properties before and after opening the request as some properties require being set at different phases of the request\n\n      safeMixin(client, request.mixin);\n      client.open(method, url, true);\n      safeMixin(client, request.mixin);\n      headers = request.headers;\n\n      for (headerName in headers) {\n        /*jshint forin:false */\n        if (headerName === 'Content-Type' && headers[headerName] === 'multipart/form-data') {\n          // XMLHttpRequest generates its own Content-Type header with the\n          // appropriate multipart boundary when sending multipart/form-data.\n          continue;\n        }\n\n        client.setRequestHeader(headerName, headers[headerName]);\n      }\n\n      request.canceled = false;\n\n      request.cancel = function cancel() {\n        request.canceled = true;\n        client.abort();\n        reject(response);\n      };\n\n      client.onreadystatechange = function\n        /* e */\n      () {\n        if (request.canceled) {\n          return;\n        }\n\n        if (client.readyState === (XHR.DONE || 4)) {\n          response.status = {\n            code: client.status,\n            text: client.statusText\n          };\n          response.headers = parseHeaders(client.getAllResponseHeaders());\n          response.entity = client.responseText; // #125 -- Sometimes IE8-9 uses 1223 instead of 204\n          // http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n\n          if (response.status.code === 1223) {\n            response.status.code = 204;\n          }\n\n          if (response.status.code > 0) {\n            // check status code as readystatechange fires before error event\n            resolve(response);\n          } else {\n            // give the error callback a chance to fire before resolving\n            // requests for file:// URLs do not have a status code\n            setTimeout(function () {\n              resolve(response);\n            }, 0);\n          }\n        }\n      };\n\n      try {\n        client.onerror = function\n          /* e */\n        () {\n          response.error = 'loaderror';\n          reject(response);\n        };\n      } catch (e) {// IE 6 will not support error handling\n      }\n\n      client.send(entity);\n    } catch (e) {\n      response.error = 'loaderror';\n      reject(response);\n    }\n  });\n});","map":{"version":3,"names":["normalizeHeaderName","responsePromise","client","headerSplitRE","require","parseHeaders","raw","headers","trim","split","forEach","header","boundary","name","value","indexOf","substring","Array","isArray","push","safeMixin","target","source","Object","keys","prop","hasOwnProperty","e","module","exports","xhr","request","promise","resolve","reject","method","url","entity","headerName","response","XHR","path","canceled","error","engine","XMLHttpRequest","mixin","open","setRequestHeader","cancel","abort","onreadystatechange","readyState","DONE","status","code","text","statusText","getAllResponseHeaders","responseText","setTimeout","onerror","send"],"sources":["D:/Chronicle/chronicle-ttm/src/main/frontend/node_modules/rest/client/xhr.js"],"sourcesContent":["/*\n * Copyright 2012-2016 the original author or authors\n * @license MIT, see LICENSE.txt for details\n *\n * @author Scott Andrews\n */\n\n'use strict';\n\nvar normalizeHeaderName, responsePromise, client, headerSplitRE;\n\nnormalizeHeaderName = require('../util/normalizeHeaderName');\nresponsePromise = require('../util/responsePromise');\nclient = require('../client');\n\n// according to the spec, the line break is '\\r\\n', but doesn't hold true in practice\nheaderSplitRE = /[\\r|\\n]+/;\n\nfunction parseHeaders(raw) {\n\t// Note: Set-Cookie will be removed by the browser\n\tvar headers = {};\n\n\tif (!raw) { return headers; }\n\n\traw.trim().split(headerSplitRE).forEach(function (header) {\n\t\tvar boundary, name, value;\n\t\tboundary = header.indexOf(':');\n\t\tname = normalizeHeaderName(header.substring(0, boundary).trim());\n\t\tvalue = header.substring(boundary + 1).trim();\n\t\tif (headers[name]) {\n\t\t\tif (Array.isArray(headers[name])) {\n\t\t\t\t// add to an existing array\n\t\t\t\theaders[name].push(value);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// convert single value to array\n\t\t\t\theaders[name] = [headers[name], value];\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// new, single value\n\t\t\theaders[name] = value;\n\t\t}\n\t});\n\n\treturn headers;\n}\n\nfunction safeMixin(target, source) {\n\tObject.keys(source || {}).forEach(function (prop) {\n\t\t// make sure the property already exists as\n\t\t// IE 6 will blow up if we add a new prop\n\t\tif (source.hasOwnProperty(prop) && prop in target) {\n\t\t\ttry {\n\t\t\t\ttarget[prop] = source[prop];\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\t// ignore, expected for some properties at some points in the request lifecycle\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nmodule.exports = client(function xhr(request) {\n\treturn responsePromise.promise(function (resolve, reject) {\n\t\t/*jshint maxcomplexity:20 */\n\n\t\tvar client, method, url, headers, entity, headerName, response, XHR;\n\n\t\trequest = typeof request === 'string' ? { path: request } : request || {};\n\t\tresponse = { request: request };\n\n\t\tif (request.canceled) {\n\t\t\tresponse.error = 'precanceled';\n\t\t\treject(response);\n\t\t\treturn;\n\t\t}\n\n\t\tXHR = request.engine || XMLHttpRequest;\n\t\tif (!XHR) {\n\t\t\treject({ request: request, error: 'xhr-not-available' });\n\t\t\treturn;\n\t\t}\n\n\t\tentity = request.entity;\n\t\trequest.method = request.method || (entity ? 'POST' : 'GET');\n\t\tmethod = request.method;\n\t\turl = response.url = request.path || '';\n\n\t\ttry {\n\t\t\tclient = response.raw = new XHR();\n\n\t\t\t// mixin extra request properties before and after opening the request as some properties require being set at different phases of the request\n\t\t\tsafeMixin(client, request.mixin);\n\t\t\tclient.open(method, url, true);\n\t\t\tsafeMixin(client, request.mixin);\n\n\t\t\theaders = request.headers;\n\t\t\tfor (headerName in headers) {\n\t\t\t\t/*jshint forin:false */\n\t\t\t\tif (headerName === 'Content-Type' && headers[headerName] === 'multipart/form-data') {\n\t\t\t\t\t// XMLHttpRequest generates its own Content-Type header with the\n\t\t\t\t\t// appropriate multipart boundary when sending multipart/form-data.\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tclient.setRequestHeader(headerName, headers[headerName]);\n\t\t\t}\n\n\t\t\trequest.canceled = false;\n\t\t\trequest.cancel = function cancel() {\n\t\t\t\trequest.canceled = true;\n\t\t\t\tclient.abort();\n\t\t\t\treject(response);\n\t\t\t};\n\n\t\t\tclient.onreadystatechange = function (/* e */) {\n\t\t\t\tif (request.canceled) { return; }\n\t\t\t\tif (client.readyState === (XHR.DONE || 4)) {\n\t\t\t\t\tresponse.status = {\n\t\t\t\t\t\tcode: client.status,\n\t\t\t\t\t\ttext: client.statusText\n\t\t\t\t\t};\n\t\t\t\t\tresponse.headers = parseHeaders(client.getAllResponseHeaders());\n\t\t\t\t\tresponse.entity = client.responseText;\n\n\t\t\t\t\t// #125 -- Sometimes IE8-9 uses 1223 instead of 204\n\t\t\t\t\t// http://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\n\t\t\t\t\tif (response.status.code === 1223) {\n\t\t\t\t\t\tresponse.status.code = 204;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (response.status.code > 0) {\n\t\t\t\t\t\t// check status code as readystatechange fires before error event\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// give the error callback a chance to fire before resolving\n\t\t\t\t\t\t// requests for file:// URLs do not have a status code\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t\t}, 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\ttry {\n\t\t\t\tclient.onerror = function (/* e */) {\n\t\t\t\t\tresponse.error = 'loaderror';\n\t\t\t\t\treject(response);\n\t\t\t\t};\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\t// IE 6 will not support error handling\n\t\t\t}\n\n\t\t\tclient.send(entity);\n\t\t}\n\t\tcatch (e) {\n\t\t\tresponse.error = 'loaderror';\n\t\t\treject(response);\n\t\t}\n\n\t});\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}